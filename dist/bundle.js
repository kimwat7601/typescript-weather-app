(()=>{"use strict";var e={8:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{renderForm(e){const t=document.createElement("section");t.classList.add("dashboard-header");const a=document.createElement("form");a.classList.add("search-form");const r=document.createElement("div");r.classList.add("dashboard-header__inner");const n=document.createElement("input");n.type="text",n.id="ipt-city-search",n.classList.add("form-input__text"),n.placeholder="都市名・郵便番号を入力",r.appendChild(n),a.appendChild(r),t.appendChild(a),e.appendChild(t)}renderCurrentWeather(e,t){this.removeParentChildElem(e);const a=document.createElement("p");a.classList.add("cur-weather-area__city-text"),a.textContent=t.city;const r=document.createElement("div");r.classList.add("cur-weather-area__weather-temperature");const n=document.createElement("figure");n.classList.add("cur-weather-area__weather-icn");const s=document.createElement("img");s.src=t.weatherIcon,s.alt=t.weatherText,n.appendChild(s);const c=document.createElement("p");c.classList.add("cur-weather-area__temperature"),c.textContent=String(t.temperature);const o=document.createElement("img");o.src="assets/images/icn_thermometer.svg",o.alt="℃",c.append(o),r.append(n,c);const i=document.createElement("ul");i.classList.add("cur-weather-area__otherinfo-box");const d=[],l=[],h=[],m=[];for(let e=0;e<3;e++){if(d[e]=document.createElement("li"),d[e].classList.add("cur-weather-area__otherinfo-item"),l[e]=document.createElement("img"),l[e].classList.add("cur-weather-area__otherinfo-icn"),h[e]=document.createElement("span"),h[e].classList.add("cur-weather-area__otherinfo-val"),m[e]=document.createElement("span"),m[e].classList.add("cur-weather-area__otherinfo-num"),d[e].append(l[e],h[e]),0===e)l[e].src="assets/images/icn_humidity.svg",l[e].alt="湿度",m[e].id="cof-num",m[e].textContent=String(t.humidity),h[e].append(m[e],"%");else if(1===e)l[e].src="assets/images/icn_wind.svg",l[e].alt="風速",m[e].id="ws-num",m[e].textContent=String(Math.round(t.windSpeed)),h[e].append(m[e],"m/s");else if(2===e){l[e].src="assets/images/icn_aerovane.svg",l[e].alt="風向き";const a=document.createElement("img");a.src="assets/images/icn_direction.svg",a.alt="方向",a.id="icn-wd",a.classList.add("icn-wd"),a.style.transform="rotate("+String(t.windDirection)+"deg)",h[e].append(a)}i.append(d[e])}e.append(a,r,i)}renderDayTabs(e,t){const a=new Date;let r=a.getDate();const n=this.calcMonthendDate(a),s=t.length,c=document.createElement("ul");c.classList.add("tab-area");const o=[],i=[];for(let t=0;t<s;t++)r++,o[t]=document.createElement("li"),o[t].classList.add("tab-item"),o[t].dataset.tabid="wday0"+String(t+1),i[t]=document.createElement("span"),i[t].classList.add("forecast-weather__day-num"),r>n&&(r=1),i[t].textContent=String(r),o[t].append(i[t],"日"),0===t&&o[t].classList.add("tab-item--is-active"),c.append(o[t]),e.append(c)}calcMonthendDate(e){return e.setMonth(e.getMonth()+1,0),e.getDate()}renderForecast(e){const t=document.createElement("li");t.classList.add("forecast-weather-list__item");const a=document.createElement("span");a.classList.add("forecast-weather-list__time"),a.textContent=e.time;const r=document.createElement("span");r.classList.add("forecast-weather-list__weather");const n=document.createElement("img");n.src=e.weatherIcon;const s=document.createElement("span");s.classList.add("forecast-weather-list__weather-text"),s.textContent=e.weatherText,r.append(n,s);const c=document.createElement("span");c.classList.add("forecast-weather-list__temp");const o=document.createElement("img");o.src="assets/images/icn_thermometer.svg",o.alt="気温",c.append(o,e.temperature);const i=document.createElement("span");i.classList.add("forecast-weather-list__cor");const d=document.createElement("img");return d.src="assets/images/icn_drop.svg",d.alt="降水確率",i.append(d,e.rop),t.append(a,r,c,i),t}renderForecastDays(e,t){const a=document.createElement("div");a.classList.add("tab-contents-wrap");const r=[],n=[];for(let e=0;e<t.length;e++)r[e]=document.createElement("div"),r[e].classList.add("tab-contents"),r[e].id="wday0"+String(e+1),n[e]=document.createElement("ul"),n[e].classList.add("forecast-weather-list"),t[e].forEach((t=>{n[e].append(this.renderForecast(t))})),r[e].append(n[e]),0===e&&r[e].classList.add("tab-contents--is-active"),a.append(r[e]);e.append(a)}renderForecastWrap(e,t){this.removeParentChildElem(e),this.renderDayTabs(e,t),this.renderForecastDays(e,t)}renderLoading(e){this.removeParentChildElem(e);const t=document.createElement("div");t.classList.add("loading-box");const a=document.createElement("div");a.classList.add("loading-box__inner");const r=document.createElement("div");r.classList.add("loader-inner","ball-clip-rotate-pulse");const n=[];for(let e=0;e<2;e++)n[e]=document.createElement("div"),r.append(n[e]);a.appendChild(r),t.appendChild(a),e.appendChild(t)}renderError(e){this.removeParentChildElem(e);const t=document.createElement("div");t.classList.add("error-message-box");const a=document.createElement("div");a.classList.add("error-message"),a.innerHTML="データを取得できませんでした。<br>しばらく経ってからもう一度お試しください。",t.appendChild(a),e.appendChild(t)}renderBody(e){const t=document.createElement("div");t.classList.add("dashboard-body");const a=document.createElement("div");a.classList.add("cur-weather-area");const r=document.createElement("div");r.classList.add("forecast-weather-area"),t.append(a,r);const n=document.createElement("div");n.classList.add("init-message-box");const s=document.createElement("div");s.classList.add("init-message"),s.innerHTML="都市名・または郵便番号で検索すると<br>ここに天気が表示されます。",n.appendChild(s),a.appendChild(n),e.appendChild(t)}removeParentChildElem(e){for(;e.firstChild;)e.removeChild(e.firstChild)}}},75:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{setCurrentWeatherInfo(e){return{city:e.name,weatherIcon:this.mapWeatherCodeToIconPath(e.weather[0].main),weatherText:e.weather[0].description,temperature:Math.round(e.main.temp),humidity:e.main.humidity,windSpeed:e.wind.speed,windDirection:e.wind.deg}}setForecastWeatherInfo(e,t){return{time:String(e)+":00",weatherIcon:this.mapWeatherCodeToIconPath(t.weather[0].main),weatherText:t.weather[0].description,temperature:String(Math.round(t.main.temp)),rop:String(Math.round(100*t.pop))+"%"}}setDaysData(e){const t=new Date;let a=[];const r=[];let n=0,s=0;for(let c=0;c<e.list.length;c++){const o=new Date(e.list[c].dt_txt);o.setHours(o.getHours()+9);const i=o.getHours()>=24?o.getHours()-24:o.getHours(),d=this.setForecastWeatherInfo(i,e.list[c]);t.getDate()!==o.getDate()&&(a[n]=d,n++,n%8!=0&&c!==e.list.length-1||(r[s]=a,a=[],n=0,s++))}return r}mapWeatherCodeToIconPath(e){let t="icn_sunny.svg";switch(e){case"Clear":t="icn_sunny.svg";break;case"Clouds":t="icn_cloudy.svg";break;case"Rain":case"Drizzle":t="icn_rain.svg";break;case"Thunderstorm":t="icn_thunder.svg";break;case"Snow":t="icn_snow.svg"}return"assets/images/"+t}}},251:function(e,t){var a=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))((function(n,s){function c(e){try{i(r.next(e))}catch(e){s(e)}}function o(e){try{i(r.throw(e))}catch(e){s(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(c,o)}i((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.apikey=e}fetchData(e){return a(this,void 0,void 0,(function*(){try{const t=yield fetch(e);if(!t.ok)throw new Error("データの取得に失敗しました");return yield t.json()}catch(e){return void(e instanceof Error?console.log("エラー："+e.message):console.log("不明なエラーが発生しました"))}}))}feachCurrentWeatherInfo(e){return a(this,void 0,void 0,(function*(){const t=`https://api.openweathermap.org/data/2.5/weather?q=${e}&units=metric&appid=${this.apikey}&lang=ja`;return yield this.fetchData(t)}))}feachForecastWeatherInfo(e){return a(this,void 0,void 0,(function*(){const t=`https://api.openweathermap.org/data/2.5/forecast?q=${e}&units=metric&appid=${this.apikey}&lang=ja`;return yield this.fetchData(t)}))}}},666:(e,t,a)=>{a.r(t),a.d(t,{config:()=>r});const r={apikey:""}},859:function(e,t,a){var r=this&&this.__awaiter||function(e,t,a,r){return new(a||(a=Promise))((function(n,s){function c(e){try{i(r.next(e))}catch(e){s(e)}}function o(e){try{i(r.throw(e))}catch(e){s(e)}}function i(e){var t;e.done?n(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(c,o)}i((r=r.apply(e,t||[])).next())}))},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(a(251)),c=n(a(75)),o=n(a(8)),i=a(666),d=document.getElementById("app"),l=i.config.apikey;console.log(l),new class{constructor(e,t){this.appElem=e,this.weatherAPI=new s.default(t),this.weatherDataProcessor=new c.default,this.weatherUIRenderer=new o.default}init(){this.weatherUIRenderer.removeParentChildElem(this.appElem),this.weatherUIRenderer.renderForm(this.appElem),this.weatherUIRenderer.renderBody(this.appElem),this.setupEventListener()}setupEventListener(){document.querySelector(".search-form").addEventListener("submit",(e=>{this.searchCity(e)})),document.querySelector(".forecast-weather-area").addEventListener(this.eventType(),(e=>{e.target.classList.contains("tab-item")&&this.changeTab(e)}))}searchCity(e){return r(this,void 0,void 0,(function*(){e.preventDefault();const t=document.getElementById("ipt-city-search"),a=t.value;t.value="";const r=document.querySelector(".cur-weather-area"),n=document.querySelector(".forecast-weather-area");try{this.weatherUIRenderer.renderLoading(r);const e=yield this.weatherAPI.feachCurrentWeatherInfo(a),t=this.weatherDataProcessor.setCurrentWeatherInfo(e);this.weatherUIRenderer.renderCurrentWeather(r,t)}catch(e){console.log("Current Data Error!"),this.weatherUIRenderer.renderError(r)}try{this.weatherUIRenderer.renderLoading(n);const e=yield this.weatherAPI.feachForecastWeatherInfo(a),t=this.weatherDataProcessor.setDaysData(e);this.weatherUIRenderer.renderForecastWrap(n,t)}catch(e){console.log("Forecast Data Error!"),this.weatherUIRenderer.renderError(n)}}))}changeTab(e){const t=document.querySelectorAll(".tab-item"),a=document.querySelectorAll(".tab-contents"),r=e.target,n=r.dataset.tabid,s=document.getElementById(n);a.forEach((e=>{e.classList.remove("tab-contents--is-active")})),t.forEach((e=>{e.classList.remove("tab-item--is-active")})),r.classList.add("tab-item--is-active"),s.classList.add("tab-contents--is-active")}eventType(){return void 0===window.ontouchstart?"click":"touchstart"}}(d,l).init()}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,a),s.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a(859)})();